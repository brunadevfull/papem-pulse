# üóÑÔ∏è Documenta√ß√£o do Banco de Dados - PAPEM

## üìã Vis√£o Geral

Sistema de banco de dados PostgreSQL para o **PAPEM - Sistema de Pesquisa de Clima Organizacional** da Marinha do Brasil.

### üéØ Objetivo
Armazenar e analisar respostas de pesquisas de clima organizacional de forma segura e an√¥nima, permitindo gera√ß√£o de relat√≥rios estat√≠sticos para tomada de decis√µes.

---

## üîß Configura√ß√£o T√©cnica

### üìä **Banco de Dados**
- **SGBD**: PostgreSQL 12+
- **Codifica√ß√£o**: UTF-8
- **Nome**: `papem_clima_organizacional`
- **Host**: localhost
- **Porta**: 5432

### üîê **Credenciais**
```
Usu√°rio: postgres
Senha: suasenha123
```

### üîó **String de Conex√£o**
```
postgresql://postgres:suasenha123@localhost:5432/papem_clima_organizacional
```

---

## üìà Estrutura do Banco

### üóÉÔ∏è **Tabela Principal: `survey_responses`**

Armazena todas as respostas da pesquisa de clima organizacional.

#### üìù **Campos e Descri√ß√µes**

| Campo | Tipo | Descri√ß√£o | Obrigat√≥rio |
|-------|------|-----------|-------------|
| `id` | serial | Identificador √∫nico da resposta | ‚úÖ |
| `created_at` | timestamp | Data/hora de cria√ß√£o | ‚úÖ |
| `ip_address` | varchar(45) | IP do respondente (controle duplica√ß√£o) | ‚úÖ |

#### üè¢ **Se√ß√£o 1: Condi√ß√µes do Ambiente de Trabalho / Conforto**

**Setor de trabalho**

| Campo | Tipo | Descri√ß√£o |
|-------|------|-----------|
| `setor_localizacao` | varchar(100) | Localiza√ß√£o do setor avaliado |
| `setor_computadores` | varchar(50) | Adequa√ß√£o dos computadores do setor |
| `setor_mobiliario` | varchar(50) | Condi√ß√µes do mobili√°rio e das instala√ß√µes |
| `setor_limpeza` | varchar(50) | Limpeza do setor |
| `setor_temperatura` | varchar(50) | Conforto t√©rmico no setor |
| `setor_iluminacao` | varchar(50) | Ilumina√ß√£o do setor |

**Alojamentos**

| Campo | Tipo | Descri√ß√£o |
|-------|------|-----------|
| `alojamento_localizacao` | varchar(100) | Alojamento avaliado |
| `alojamento_limpeza` | varchar(50) | Limpeza do alojamento |
| `alojamento_temperatura` | varchar(50) | Conforto t√©rmico no alojamento |
| `alojamento_iluminacao` | varchar(50) | Ilumina√ß√£o do alojamento |
| `alojamento_armarios_condicao` | varchar(50) | Condi√ß√µes de pintura/preserva√ß√£o dos arm√°rios |
| `alojamento_armario_preservado` | varchar(50) | Autoavalia√ß√£o sobre preserva√ß√£o do arm√°rio pessoal |

**Banheiros**

| Campo | Tipo | Descri√ß√£o |
|-------|------|-----------|
| `banheiro_localizacao` | varchar(100) | Banheiro avaliado |
| `banheiro_vasos_suficientes` | varchar(50) | Quantidade de vasos sanit√°rios |
| `banheiro_vasos_preservados` | varchar(50) | Limpeza/preserva√ß√£o dos vasos |
| `banheiro_torneiras_funcionam` | varchar(50) | Funcionamento das torneiras |
| `banheiro_chuveiros_suficientes` | varchar(50) | Quantidade de chuveiros |
| `banheiro_chuveiros_funcionam` | varchar(50) | Funcionamento dos chuveiros |
| `banheiro_limpeza` | varchar(50) | Limpeza geral |
| `banheiro_iluminacao` | varchar(50) | Ilumina√ß√£o |

**Sal√µes de recreio**

| Campo | Tipo | Descri√ß√£o |
|-------|------|-----------|
| `recreio_localizacao` | varchar(100) | Sal√£o de recreio avaliado |
| `recreio_mobiliario_quantidade` | varchar(50) | Quantidade de mobili√°rio dispon√≠vel |
| `recreio_mobiliario_condicao` | varchar(50) | Conserva√ß√£o do mobili√°rio |
| `recreio_limpeza` | varchar(50) | Limpeza do sal√£o |
| `recreio_temperatura` | varchar(50) | Conforto t√©rmico |
| `recreio_iluminacao` | varchar(50) | Ilumina√ß√£o |

**Rancho**

| Campo | Tipo | Descri√ß√£o |
|-------|------|-----------|
| `rancho_localizacao` | varchar(100) | Local do rancho avaliado |
| `rancho_qualidade_comida` | varchar(50) | Qualidade da alimenta√ß√£o |
| `rancho_mobiliario_condicao` | varchar(50) | Condi√ß√£o e limpeza do mobili√°rio |
| `rancho_limpeza` | varchar(50) | Limpeza geral do rancho |
| `rancho_temperatura` | varchar(50) | Conforto t√©rmico no rancho |
| `rancho_iluminacao` | varchar(50) | Ilumina√ß√£o do rancho |

**Escala de servi√ßo e TFM**

| Campo | Tipo | Descri√ß√£o |
|-------|------|-----------|
| `escala_servico_tipo` | varchar(100) | Escala de servi√ßo do respondente |
| `escala_equipamentos_condicao` | varchar(50) | Condi√ß√µes dos equipamentos utilizados em servi√ßo |
| `escala_pernoite_adequada` | varchar(50) | Adequa√ß√£o das instala√ß√µes de pernoite |
| `tfm_participa_regularmente` | varchar(50) | Frequ√™ncia na participa√ß√£o do TFM |
| `tfm_incentivo_pratica` | varchar(50) | Incentivo institucional ao TFM |
| `tfm_instalacoes_adequadas` | varchar(50) | Adequa√ß√£o das instala√ß√µes para o TFM |

#### üë• **Se√ß√£o 2: Relacionamento**

| Campo | Tipo | Descri√ß√£o |
|-------|------|-----------|
| `encarregado_ouve_melhorias` | varchar(50) | Encarregado escuta propostas de melhoria |
| `encarregado_fornece_meios` | varchar(50) | Encarregado disponibiliza recursos necess√°rios |
| `disposicao_contribuir_setor` | varchar(50) | Interesse pessoal em contribuir com o setor |
| `encarregado_delega` | varchar(50) | Capacidade do encarregado em delegar responsabilidades |
| `pares_auxiliam_setor` | varchar(50) | Apoio dos pares na resolu√ß√£o de problemas |
| `relacionamento_intersetorial` | varchar(50) | Qualidade do relacionamento entre setores |
| `entrosamento_tripulacao` | varchar(50) | Integra√ß√£o entre integrantes da tripula√ß√£o |
| `convivencia_regras` | varchar(50) | Conviv√™ncia alinhada √†s regras de bom conv√≠vio |
| `confianca_respeito_relacoes` | varchar(50) | Confian√ßa e respeito no ambiente |
| `integracao_familia_papem` | varchar(50) | A√ß√µes para integrar √† Fam√≠lia PAPEM |

#### üöÄ **Se√ß√£o 3: Motiva√ß√£o / Desenvolvimento Profissional**

| Campo | Tipo | Descri√ß√£o |
|-------|------|-----------|
| `feedback_desempenho_regular` | varchar(50) | Frequ√™ncia de feedback sobre desempenho |
| `conceito_compativel_desempenho` | varchar(50) | Compatibilidade entre conceito e desempenho |
| `importancia_funcao_papem` | varchar(50) | Percep√ß√£o da import√¢ncia da fun√ß√£o |
| `trabalho_reconhecido_valorizado` | varchar(50) | Reconhecimento e valoriza√ß√£o do trabalho |
| `crescimento_profissional_estimulado` | varchar(50) | Est√≠mulo ao crescimento profissional |
| `cursos_suficientes_atividade` | varchar(50) | Cursos/treinamentos suficientes para a atividade |
| `programa_adestramento_regular` | varchar(50) | Exist√™ncia de programa regular de adestramento |
| `orgulho_trabalhar_papem` | varchar(50) | Orgulho em atuar na PAPEM |
| `atuacao_area_especializacao` | varchar(50) | Atua√ß√£o alinhada √† especializa√ß√£o |
| `potencial_melhor_em_outra_funcao` | varchar(50) | Percep√ß√£o sobre melhor aproveitamento em outra fun√ß√£o |
| `carga_trabalho_justa` | varchar(50) | Justi√ßa na carga de trabalho |
| `licenca_autorizada_sem_prejuizo` | varchar(50) | Facilidade para concess√£o de licen√ßas especiais |

#### üí¨ **Se√ß√£o 4: Coment√°rios**

| Campo | Tipo | Descri√ß√£o |
|-------|------|-----------|
| `aspecto_positivo` | text | Destaques positivos sobre a OM |
| `aspecto_negativo` | text | Aspectos que precisam ser solucionados |
| `proposta_processo` | text | Ideias para melhoria de processos |
| `proposta_satisfacao` | text | Sugest√µes para satisfa√ß√£o/motiva√ß√£o da tripula√ß√£o |

### üìä **Tabela de Estat√≠sticas: `survey_stats`**

| Campo | Tipo | Descri√ß√£o |
|-------|------|-----------|
| `id` | serial | Identificador √∫nico |
| `total_responses` | integer | Total de respostas |
| `last_updated` | timestamp | √öltima atualiza√ß√£o |

---

## üé≠ **Valores das Respostas Likert**

Todas as quest√µes de escala Likert utilizam os seguintes valores:

- **"Concordo totalmente"**
- **"Concordo"**
- **"Discordo"**
- **"Discordo totalmente"**

---

## üîê **Seguran√ßa e Privacidade**

### üîí **Anonimato Garantido**
- ‚úÖ Nenhum dado pessoal √© armazenado
- ‚úÖ IP usado apenas para controle de duplica√ß√£o
- ‚úÖ N√£o h√° rastreamento de usu√°rios individuais

### üõ°Ô∏è **Controles de Integridade**
- ‚úÖ Valida√ß√£o de dados obrigat√≥rios
- ‚úÖ Preven√ß√£o de respostas duplicadas por IP
- ‚úÖ Valida√ß√£o de tipos de dados

---

## üîÑ **Relacionamentos e Regras de Neg√≥cio**

### üìã **Regras Condicionais**

1. **Localiza√ß√µes obrigat√≥rias**: setor, alojamento, banheiro, sal√£o de recreio, rancho e escala exigem sele√ß√£o de uma op√ß√£o.
2. **Likert obrigat√≥rias**: todas as perguntas de escala relacionadas ao bloco escolhido devem ser respondidas.
3. **TFM**: perguntas sobre participa√ß√£o, incentivo e instala√ß√µes do Treinamento F√≠sico Militar s√£o sempre obrigat√≥rias.

---

## üìä **√çndices e Performance**

### üöÄ **√çndices Recomendados**
```sql
-- √çndice para consultas por setor
CREATE INDEX idx_survey_setor ON survey_responses(setor_localizacao);

-- √çndice para consultas por rancho
CREATE INDEX idx_survey_rancho ON survey_responses(rancho_localizacao);

-- √çndice para consultas por escala
CREATE INDEX idx_survey_escala ON survey_responses(escala_servico_tipo);

-- √çndice para consultas temporais
CREATE INDEX idx_survey_created ON survey_responses(created_at);

-- √çndice para controle de duplica√ß√£o
CREATE INDEX idx_survey_ip ON survey_responses(ip_address);
```

---

## üîß **Scripts de Manuten√ß√£o**

### üßπ **Limpeza de Dados Teste**
```sql
-- Remover dados de teste
DELETE FROM survey_responses WHERE ip_address = '127.0.0.1';
```

### üìà **Consultas de An√°lise**

#### Total de Respostas por Setor
```sql
SELECT setor_localizacao, COUNT(*) as total
FROM survey_responses
WHERE setor_localizacao IS NOT NULL
GROUP BY setor_localizacao
ORDER BY total DESC;
```

#### Satisfa√ß√£o Geral por Escala
```sql
SELECT escala_servico_tipo,
       CASE resposta
         WHEN 'Concordo totalmente' THEN 'Muito satisfat√≥rio'
         WHEN 'Concordo' THEN 'Satisfat√≥rio'
         WHEN 'Discordo' THEN 'Insatisfat√≥rio'
         WHEN 'Discordo totalmente' THEN 'Muito insatisfat√≥rio'
         ELSE 'Neutro'
       END AS classificacao,
       COUNT(*) AS total
FROM survey_responses
CROSS JOIN LATERAL (
  VALUES
    (setor_computadores),
    (setor_mobiliario),
    (setor_limpeza),
    (setor_temperatura),
    (setor_iluminacao),
    (rancho_qualidade_comida),
    (escala_equipamentos_condicao),
    (escala_pernoite_adequada)
) AS respostas(resposta)
WHERE escala_servico_tipo IS NOT NULL AND resposta IS NOT NULL
GROUP BY escala_servico_tipo, classificacao
ORDER BY escala_servico_tipo, total DESC;
```

#### Respostas por Per√≠odo
```sql
SELECT DATE(created_at) as data, COUNT(*) as respostas
FROM survey_responses
GROUP BY DATE(created_at)
ORDER BY data DESC;
```

---

## üÜò **Backup e Recupera√ß√£o**

### üíæ **Backup Completo**
```bash
pg_dump -h localhost -U postgres -d papem_clima_organizacional > backup_papem_$(date +%Y%m%d_%H%M%S).sql
```

### üîÑ **Restaura√ß√£o**
```bash
psql -h localhost -U postgres -d papem_clima_organizacional < backup_papem_YYYYMMDD_HHMMSS.sql
```

---

## üìû **Suporte T√©cnico**

### üîç **Troubleshooting Comum**

1. **Erro de Conex√£o**:
   ```bash
   # Verificar se PostgreSQL est√° rodando
   sudo systemctl status postgresql
   
   # Iniciar se necess√°rio
   sudo systemctl start postgresql
   ```

2. **Erro de Permiss√£o**:
   ```sql
   -- Dar permiss√µes ao usu√°rio
   GRANT ALL PRIVILEGES ON DATABASE papem_clima_organizacional TO postgres;
   ```

3. **Verificar Espa√ßo em Disco**:
   ```sql
   SELECT pg_size_pretty(pg_database_size('papem_clima_organizacional'));
   ```

---

*Documenta√ß√£o gerada automaticamente pelo Sistema PAPEM - Atualiza√ß√£o 2025*
